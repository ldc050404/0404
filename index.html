<script>
/* 데이터 */
// ... (위 데이터 부분 그대로)

/* tier 색상 */
// ... (그대로)

let activeTier = "전체";
let searchQuery = "";

const tableBody = document.getElementById("tableBody");
const searchInput = document.getElementById("searchInput");

/* ===== 모달 관련 ===== */
function openModal(name, tier, maxLv) {
  document.getElementById("modalTitle").textContent = name;
  document.getElementById("modalTier").textContent = `등급: ${tier} / 최대 레벨: ${maxLv}`;
  document.getElementById("modalDesc").textContent =
    "상세 설명을 여기에 넣을 수 있습니다."; // 더미 텍스트 유지
  document.getElementById("modalBackdrop").style.display = "flex";
}

function closeModal(e) {
  if (e.target.id === "modalBackdrop") {
    document.getElementById("modalBackdrop").style.display = "none";
  }
}

/* 테이블 렌더 */
function renderTable(list){
  tableBody.innerHTML = "";
  if(!list.length){
    const tr = document.createElement("tr");
    tr.innerHTML = `<td colspan="5" style="padding:26px;text-align:center;color:var(--muted)">
      검색 결과가 없습니다.
    </td>`;
    tableBody.appendChild(tr);
    return;
  }

  list.forEach(([tier,name], idx)=>{
    const tr = document.createElement("tr");
    tr.className = "enchant-row";

    /* ============================
       ⭐ 클릭 이벤트 추가된 부분 ⭐
       ============================ */
    tr.addEventListener("click", () => {
      const maxLv = MAX_LEVELS[ENCHANTS.indexOf([tier, name])];
      openModal(name, tier, maxLv);
    });

    const nameTd = document.createElement("td");
    nameTd.innerHTML = `
      <div class="name-col">
        <img src="0003.png" alt="인챈트북">
        <div>
          <div style="font-weight:700">${name}</div>
          <div class="right-muted" style="margin-top:4px">${name} 인챈트</div>
        </div>
      </div>
    `;

    const gradeTd = document.createElement("td");
    const bg = TIER_COLORS[tier];
    const txt = tier === "일반" ? "#000" : "#fff";
    gradeTd.innerHTML = `<span class="tier-badge" style="background:${bg};color:${txt}">${tier}</span>`;

    const tierTd = document.createElement("td");
    tierTd.innerHTML = `<div class="right-muted">티어 정보</div>`;

    const lvlTd = document.createElement("td");
    lvlTd.innerHTML = `<strong>${MAX_LEVELS[idx] ?? ""}</strong>`;

    const itemTd = document.createElement("td");
    itemTd.innerHTML = `<div class="right-muted">아이템 정보</div>`;

    tr.appendChild(nameTd);
    tr.appendChild(gradeTd);
    tr.appendChild(tierTd);
    tr.appendChild(lvlTd);
    tr.appendChild(itemTd);

    tableBody.appendChild(tr);
  });
}

function getFiltered(){
  const q = searchQuery.trim();
  return ENCHANTS.filter(([tier,name])=>{
    if(activeTier!=="전체" && activeTier!==tier) return false;
    if(q && !name.includes(q)) return false;
    return true;
  });
}

function onFilterChange(){
  searchQuery = searchInput.value;
  renderTable(getFiltered());
}

function toggleTier(tier){
  activeTier = tier;
  document.querySelectorAll(".tier-btn").forEach(btn=>{
    btn.classList.toggle("active", btn.dataset.tier===tier);
  });
  if(tier==="전체") activeTier="전체";
  renderTable(getFiltered());
}

renderTable(ENCHANTS);

searchInput.addEventListener("keydown",e=>{
  if(e.key==="Enter") onFilterChange();
});
</script>
